# 通信プロトコル　※頻出分野（2~5 問）

## OSI 参照モデル

OSI 参照モデルは、コンピュータの通信プロトコルのモデル。  
OSI 参照モデルでは通信プロトコルが 7 層に分かれている。まずはこの参照モデルを押さえておく必要がある！！！

上の層から順に

7.アプリケーション層：どんなサービスを提供するか  
6.プレゼンテーション層：データの形式  
5.セッション層：通信の開始から終了までを管理  
4.トランスポート層：通信の信頼性の保証（TCP/UDP）  
3.ネットワーク層：ネットワーク同士の中継  
2.データリンク層：同一ネットワーク内でどう通信するか  
1.物理層：物理的にどう繋ぐか

覚え方としては、上から「アプセトネデブ」と覚えると良い。

■ 参考  
[【初心者必見】OSI 参照モデル アプセトネデブで覚えよう](https://envader.plus/article/38)  
キタミ式 p516 プロトコルと OSI 基本参照モデル

### 第一層 物理層

■ 役割
データをビット(0,1)の形で電気信号や光信号として送受信したり増幅したりする。  
要は、「物理的な通信手段（ケーブル、電波など）」を扱う層。

■ 代表的な機器  
・LAN ケーブル  
・リピータ：中継機器。ケーブルを流れる電気信号を増幅して、LAN の総延長距離を伸ばす  
・NIC(Network Interface Card)：コンピュータをネットワークに雪像するための拡張カード。データを電気信号に変換してケーブルに流す  
・Wifi

### 第二層 データリンク層

■ 役割  
異なるセグメント間（セグメントは論理的に 1 本のケーブルで繋がっている範囲）とのデータ転送を行う。

■ 代表的な機器  
・ブリッジ：流れてきたパケットの MAC アドレス情報を確認し、必要に応じて他方のセグメントへパケットを流す

■ プロトコル  
・ARP(Address Resolution Protocol)　※よく出る

### 第三層 ネットワーク層

■ 役割  
ネットワーク層は、異なるネットワーク間の通信を担う。  
異なるネットワーク間の通信を実現するために、通信相手を特定できるようにする方法として IP アドレス情報を使う。

■ 代表的な機器  
・ルータ

■ プロトコル  
・IP

### ゲートウェイ

ゲートウェイは、第四層 トランスポート層以上で異なるネットワーク間でプロトコル変換による中継機能を提供する装置。

## OSI 参照モデルと TCP/IP の関係図

<img width="636" alt="Image" src="https://github.com/user-attachments/assets/5593e8eb-1131-4f7b-9dff-ab007af2dd82" />

引用元：[OSI 参照モデルとは？TCP/IP との違いを図解で解説](https://www.itmanage.co.jp/column/osi-reference-model/)

# 第二層 データリンク層のプロトコル

■ キーワード
★ARP、RARP  
・PPP  
・PPPoE  
・IPoE  
・VLAN

## ★ARP(Address Resolution Protocol)　とてもよく出る！！！過去 10 問ほど

アドレス解決プロトコル。IP アドレスから対応する機器の MAC アドレスを取得するプロトコル。  
ネットワーク通信では、データを送る際に宛先の MAC アドエスが必要だが、IP アドレスしかわからない場合に使われる。  
例えば、「初めて通信する相手にデータを送る時」「デフォルトゲートウェイ（ルーター）に通信する時」など

以下の手順で IP アドレスから MAC アドレスを取得する。

1. 要求パケットに MAC アドレスを取得したい IP アドレスと、送信元の IP アドレス・MAC アドレスを格納して同一セグメント内にブロードキャストする
2. 要求パケットを受け取った各ノードは、自分の IP アドレスであれば自分の MAC アドレスを送信元に伝える

※ブロードキャストとは、ネットワーク上のすべての端末に対して同じデータを一斉送信すること  
※逆に 1 対 1 の通信を、ユニキャストという。ARP の応答パケットはユニキャスト

また逆に、MAC アドレスから IP アドレスを取得するプロトコルを「RARP(Reverse Address Resolution Protocol)」という。

### ■ 参考過去問

・[ARP の説明はどれか R3 秋 32, H28 秋 32, H24 春 33, H20 秋 53](https://www.ap-siken.com/bunya.php?m=10&s=3&no=21)  
・[ARP の説明として適切なものはどれか R1 秋 33](https://www.ap-siken.com/bunya.php?m=10&s=3&no=29)  
・[RARP の機能として適切なもの H30 春 34, H25 春 33, H19 春 51](https://www.ap-siken.com/bunya.php?m=10&s=3&no=35)  
・[MAC アドレスを取得するプロトコル H29 秋 34](https://www.ap-siken.com/bunya.php?m=10&s=3&no=37)  
・[ARP 要求・応答パケット H23 特 37](https://www.ap-siken.com/bunya.php?m=10&s=3&no=66)  
・[RARP H22 秋 36](https://www.ap-siken.com/bunya.php?m=10&s=3&no=67)

## PPP(Point-to-Point Protocol)

PPP(Point-to-Point Protocol)は、2 つのネットワーク機器（主にルーターや PC）を直接接続してデータ通信を行うための通信プロトコル。  
電話回線（ダイヤルアップ）、ISDN、シリアル接続などで使われていた。

PPP 通信には、リンク制御プロトコル(LCP)とネットワーク制御プロトコル(NCP)の 2 つの通信プロトコルが使用されている。

### ■ 参考過去問

・[PPP H29 春 33, H26 春 32, H20 秋 55](https://www.ap-siken.com/bunya.php?m=10&s=3&no=39)  
・[PPP に関する記述 H20 春 56](https://www.ap-siken.com/bunya.php?m=10&s=3&no=77)

## PPPoE(PPP over Ethernet)

PPPoE は、Ethernet（イーサネット）を使って、PPP を実現するためのプロトコル。  
PPPoE は家庭や企業のインターネット接続でよく使われる。

PPP の機能である認証、暗号化、圧縮などを Ethernet 上で利用できるようにしたもの。

■Ethernet とは？  
Ethernet は、LAN 内でデバイス同士を接続しデータを送受信するための標準的な通信プロトコル。家庭やオフィスのネットワークで一般的に使われている。  
OSI 参照モデルの物理層とデータリンク層動作する。

### ■ 参考過去問

・[PPPoE R4 春 32](https://www.ap-siken.com/bunya.php?m=10&s=3&no=17)

# 第三層 ネットワーク層のプロトコル

■ キーワード  
・IP アドレス  
・サブネットアドレス  
・サブネットマスク  
・ブロードキャスト  
・ユニキャスト  
・マルチキャスト  
・ICMP  
・CIDR  
・IPv6

## IP アドレス

### IP アドレスの構成

IP アドレスは、「ネットワークアドレス部」「ホストアドレス部」で構成されている。  
IP アドレスはネットワークの規模によって「クラス（A,B,C）」が分かれている。クラスによって、IP アドレス 32 ビットのうち、何ビットをネットワークアドレス部に割り当てるか規定されている。

- クラス A（大規模）：ネットワーク部 8 ビット、ホストアドレス部 24 ビット
  - 0.0.0.0〜127.255.255.255。先頭ビットは「0」
- クラス B（中規模）：ネットワーク部 16 ビット、ホストアドレス部 16 ビット
  - 128.0.0.0〜191.255.255.255。先頭ビットは「10」
- クラス C（小規模）：ネットワーク部 24 ビット、ホストアドレス部 8 ビット
  - 192.0.0.0〜223.255.255.255。先頭ビットは「110」
  - この中の、192.168.0.0〜192.168.255.255 がプライベート IP

クラス C の場合、8 ビットなので 256 台。ただし、ネットワークアドレス（すべてが 0）、ブロードキャストアドレス（すべてが 1）は割り当てできないため、割り当て可能なホスト数は 256-2=254 台である。

### ブロードキャスト

同一ネットワーク内のすべてのホストに対して一斉に同じデータを送信すること。

### ユニキャスト

特定の 1 台のみに送信すること。

・メーリングリスト  
メーリングリストにメールを送信する場合は、メーリングリスト用のアドレスにユニキャストで送信して、受信したメールサーバ側で複製したメールを各ユーザにユニキャストで送信する仕組み。

### マルチキャスト

複数ではあるけれど不特定多数ではなく決められた範囲内の複数ホストに送信すること。

### ■ 参考過去問

・[マルチキャストの使用例 R5 秋 35](https://www.ap-siken.com/bunya.php?m=10&s=3&no=9)  
・[ブロードキャストフレーム R3 秋 31, H30 秋 33, H25 秋 34, H19 秋 57, H17 秋 59](https://www.ap-siken.com/bunya.php?m=10&s=3&no=20)  
・[ブロードキャストアドレスを得る演算 R3 秋 35](https://www.ap-siken.com/bunya.php?m=10&s=3&no=23)  
・[ブロードキャストストームはどれか H29 春 35](https://www.ap-siken.com/bunya.php?m=10&s=3&no=40)  
・[IP マルチキャスト H18 秋 51](https://www.ap-siken.com/bunya.php?m=10&s=3&no=86)

## ★ サブネットマスク　よく出る！！！過去 20 問ほど

IP アドレスで一番小規模なクラス C でも 254 台ホストが使える。ただ、ここまでの台数必要がなくネットワークをさらに分割したい場合に使えるのが、サブネットマスク。  
サブネットマスクは、IP アドレスのネットワーク部とホストアドレス部を再定義することができる（1 がネットワークアドレス、0 がホストアドレスを示す）

例）クラス C の IP アドレスに対して、サブネットマスクを 255.255.255.192 とした場合  
クラス C の IP =11111111.11111111.11111111.00000000  
サブネットマスク =11111111.11111111.11111111.11000000

クラス C のホストアドレス部の中でさらに上位 2 ビットをサブネットに分割しているということ。サブネットは「00」「01」「10」「11」の 4 つのサブネットに拡張される。  
★IP アドレスが属するネットワーク部を求めたい場合は、IP アドレスとサブネットマスクの論理積(AND)で求めることができる。

よくわからなくなったら、キタミ式 p553 を復習しよう！

### ■ 参考過去問

・[どのアドレスに該当するか R6 春 31, H28 秋 33](https://www.ap-siken.com/bunya.php?m=10&s=3&no=4)  
・[サブネットワークのアドレス R5 秋 34, H26 秋 34, H18 秋 53](https://www.ap-siken.com/bunya.php?m=10&s=3&no=8)  
・[サブネットマスク H28 春 35, H25 春 34, H20 春 53, H17 秋 52](https://www.ap-siken.com/bunya.php?m=10&s=3&no=47)  
・[IP アドレス R4 秋 33](https://www.ap-siken.com/bunya.php?m=10&s=3&no=14)  
・[接続可能なホストの最大数 R4 春 34](https://www.ap-siken.com/bunya.php?m=10&s=3&no=19)  
・[ホストアドレスを求める式はどれか R3 春 34, H27 秋 34](https://www.ap-siken.com/bunya.php?m=10&s=3&no=26)  
・[ネットワークアドレス H31 春 34](https://www.ap-siken.com/bunya.php?m=10&s=3&no=32)  
・[ネットワーク機器のアドレスはどれか H30 秋 34](https://www.ap-siken.com/bunya.php?m=10&s=3&no=34)  
・[IP ネットワークの集約 H30 春 35, H24 春 34](https://www.ap-siken.com/bunya.php?m=10&s=3&no=36)  
・[同じサブネットワークの IP アドレス H27 春 36](https://www.ap-siken.com/bunya.php?m=10&s=3&no=51)  
・[ブロードキャストアドレスはどれか H26 春 33](https://www.ap-siken.com/bunya.php?m=10&s=3&no=55)  
・[可変長サブネットマスク H25 秋 32](https://www.ap-siken.com/bunya.php?m=10&s=3&no=56)

## CIDR(Classless Inter-Domain Routing)表記

IP アドレスとサブネットマスクはセットのため、まとめて記載することもある。  
サブネットマスクを記述する際は IP アドレスの後ろに「/サブネットマスク」として記載する。  
例）198.168.1.3/255.255.255.0

ただ、これだと長い。サブネットマスクのネットワーク部のビット数に注目した CIDR 記法を使うと、「198.168.1.3/24」と表記できる。

## ICMP(Internet Control Message Protocol)

ICMP は、IP の通信制御を補完するプロトコル。データ配送中のエラー通知や送達エラーを通知する機能を持つ。

■ICMP の代表的な機能  
・ping：ネットワークの疎通確認  
・宛先に到達不能な時のエラーメッセージ  
・正しい経路へのリダイレクトメッセージ

### ■ 参考過去問

・[ICMP の機能はどれか R6 秋 34](https://www.ap-siken.com/bunya.php?m=10&s=3&no=2)  
・[ping で使用されるプロトコル R5 秋 33, H29 春 32](https://www.ap-siken.com/bunya.php?m=10&s=3&no=7)

# 第四層 トランスポート層のプロトコル

## ★TCP と UDP 　とてもよく出る！！！

トランスポート層のプロトコルには以下のものがある。  
・TCP：コネクション型の通信プロトコル。送受信するデータの信頼性を保証  
・UDP：コネクションレス型の通信プロトコル。データの信頼性よりリアルタイム性を重視

UDP では、データが届いたかどうかよりも多少データがかけていてもリアルタイム性が重視されるストリーミングサービス、音声通話、オンラインゲームなどで使われる。

■ 参考過去問  
・[IP の上位階層のプロトコル R4 秋 34, H26 秋 33, H23 秋 37, H19 秋 51](https://www.ap-siken.com/bunya.php?m=10&s=3&no=15)  
・[UDP を使用しているもの R4 春 33](https://www.ap-siken.com/bunya.php?m=10&s=3&no=18)  
・[トランスポート層に位置するもの R5 春 34, H25 秋 35, H21 秋 36, H19 春 52](https://www.ap-siken.com/bunya.php?m=10&s=3&no=11)  
・[UDP ヘッダーになくて TCP ヘッダーにある情報 R3 秋 34](https://www.ap-siken.com/bunya.php?m=10&s=3&no=22)  
・[TCP コネクションが設定される場所](https://www.ap-siken.com/bunya.php?m=10&s=3&no=97)
