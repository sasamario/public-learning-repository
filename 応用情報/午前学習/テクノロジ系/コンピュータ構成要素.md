# 学習まとめ

## CPU の高速化技術

逐次制御方式で命令を処理していくと、処理の待ち時間が長くなってしまうため工夫が必要。いくつかの高速化技術についていかにまとめる。

### 前提

命令の処理の流れは以下の通り。

1. 命令の取り出し
2. 命令の解読
3. 対象データの読み出し
4. 命令実行

### パイプライン処理

命令の処理の流れを全て行ってから次の命令に行くのではなく、命令の取り出しをしたら解読している間に、次の命令の取り出しを行うような処理。  
待ち時間をなくすことができるので、高速化が図れる。ただ、命令を先読みしているので分岐命令が出た場合先読み分が無駄になることがある。  
これをハザードといい、分岐命令に起因するものを制御（分岐）ハザードという。

パイプライン処理では分岐条件によっては、他の命令の結果がわからないと処理ができないものもある。そういった場合に行うのが「分岐処理」「投機実行」

#### 分岐予測と投機実行

分岐予測とは、分岐条件のところで次の命令がどれか予測することで無駄な待ち時間を発生させないようにするもの。  
この予測に基づいて、無駄になるかもしれないがとりあえず先に処理をしておくことを、「投機実行」という。

### 参考

キタミ式 CPU の高速化技術 p193〜

## ディスプレイの種類と特徴

- CRT ディスプレイ（ブラウン管）：電子を発光体に衝突させて生じる発光で表示する仕組み
- 液晶ディスプレイ：電圧によって液晶を制御し、バックライトや外部からの光を取り込むことで表示する仕組み
- 有機 EL ディスプレイ：有機化合物に電圧を加えることで発光する仕組み。自らが発行するため、液晶ディスプレイのようなバックライトが不要
- プラズマディスプレイ：プラズマ放電による発光を利用する仕組み。高電圧が必要

## 主記憶への書き込み方式

■ 前提  
記憶装置ごとに速度差がある。CPU のレジスタ > メモリ（主記憶装置） > HDD。この速度差のギャップを埋める手法がキャッシュ。  
CPU は動作に必要なデータやプログラムを主記憶装置との間でやりとりをしている。ただ、CPU に比べて遅いため待ち時間が発生してしまう。  
そこで、CPU と主記憶装置の間により早いキャッシュメモリを用意することで速度差を減らしている。

キャッシュメモリは読み出しだけでなく、書き込みでも使用される。書き込みの場合、更新した内容を主記憶装置にも反映する必要がある。その書き換える方式は以下の 2 つがある。

### ライトスルー方式

キャッシュメモリに書き込みを行う際に、主記憶装置へ同時に書き込みを行う方式。

メリット：キャッシュメモリと主記憶装置でデータの一貫性を保つ（コピーレンシ）ことができる点  
デメリット：速度が遅い主記憶装置にも書き込みを行うため、速度が遅くなる点

### ライトバック方式

普段はキャッシュメモリにしか書き込みを行わず、キャッシュメモリから追い出されるデータが発生した場合に、その内容を主記憶装置へ書き戻して更新内容を反映させる方式。

メリット：普段はキャッシュメモリにしか書き込まないため高速化できる点
デメリット：制御が難しい点

## キャッシュメモリの割り当て方式

### ダイレクトマッピング方式

1 つのメモリブロックを、**「キャッシュ内の単一のロケーション」**に割り当てる方式。  
ハッシュ演算を用いて、主記憶のブロック番号からキャッシュ内のロケーションを求め、データの割り当てを行う。

### フルアソシエイティブ方式

メモリブロックを、**「キャッシュ内の任意のロケーション」**に割り当てる方式。  
キャッシュメモリの空いているところを使用する。ただ、管理が複雑で読み出すたびに全体を検索する必要があり速度に難がある。

### セットアソシエイティブ方式

メモリブロックを、キャッシュ内の **「2 つ以上の配置可能なロケーション」**に割り当てる方式。
空いているセットならどこでも使用することができる。ダイレクトマッピングとフルアソシエイティブの折衷案のようなもの。これが一般的に使われているとのこと。

## メモリインターリーブ

主記憶へのアクセスを高速化する方法として、キャッシュメモリの使用以外にメモリインターリーブという方法がある。  
これは主記憶の中を複数の区画（バンク）に分割し、分割した区画を横断する形でデータを割り当てる。  
そうすることで、複数のバンクに同時にアクセスすることで一気にデータを読み出すことで高速化できる。ただ、ランダムアクセスのような連続していないデータの読み出しではあまり効果がない。

## メモリの分類

キタミ式 p208〜  
メモリは大きく RAM と ROM がある。

- RAM(Random Access Memory)
- ROM(Read Only Memory)

### RAM（Random Access Memory）

#### ■ RAM の特徴

- 読み書き可
- 揮発性(電源を切ると中身が消えてしまう)

主記憶装置に使われる「DRAM」やキャッシュメモリに使われる「SRAM」などがある。

#### ■DRAM の特徴

- 安価で容量が大きい
- 読み書きは SRAM に比べて低速
- 記憶内容を保つためには定期的に内容を再書き込みするリフレッシュ動作が必要
- 仕組みとしては、コンデンサに電荷を蓄えてビット情報を記録。ただ、時間経過で電荷が抜けてしまうため、リフレッシュが必要

#### ■SRAM の特徴

- DRAM に比べて高速
- 高価なため、小容量のキャッシュメモリに用いられる
- DRAM のような記憶内容を保持するのにリフレッシュ動作は必要ない
- 仕組みとしては、フリップフロップ回路を使っている

### ROM（Read Only Memory）

#### ■ ROM の特徴

- 読み出しだけ可 ※専用の機器を使うと記憶内容の消去と書き込みができるものもある
- 不揮発性（電源を切っても中身は消えない）

電源を切っても消えないので、HDD などで使用されている。

#### ■ROM の種類

- マスク ROM：いわゆる ROM と呼ばれるもの。製造時にデータを書き込み、以降は内容を書き換えることができない
- PROM(Programmable ROM)：ユーザの手で書き換えることができる ROM
  - EPROM：紫外線でデータを書鋸歯て書き換えることができる
  - EEPROM：電気的にデータを消去して書き換えることができる
  - フラッシュメモリ：EEPROM の１種。ブロック単位でデータを消去して書き換えることができる
