# 概要

Vite で構築した環境（フロント）を GithubPages にデプロイする際の設定について記載する。

# Github 側の設定

## ブランチ保護ルールの設定

自動デプロイできるようにするなら、誤って本番用のブランチに push できないようルールを設定する必要がある。  
参考サイトをもとに、PR 経由でないとマージできない設定をする。

■ 参考

- [ブランチ保護ルールを管理する](https://docs.github.com/ja/repositories/configuring-branches-and-merges-in-your-repository/managing-protected-branches/managing-a-branch-protection-rule)
- [github repository rules がリリースされたので設定してみる](https://qiita.com/nero-15/items/7285ec680469b09c8fdf)

## Github Actions の有効化

Github Pages でビルドからデプロイまでの一連の処理を、Github Actions のワークフローで自動実行するように設定する。  
Settings > Pages > Build and deployment で「GitHub Actions」を選択

これにより、自分で作成したワークフローに従って、ビルドとデプロイが実行されるようになる。

## ワークフローの作成

プロジェクトにワークフロー用の設定ファイルを用意する。  
.github/workflows/deploy.yml

# Vite 側の準備

■ 参考

- [静的サイトのデプロイ](https://ja.vite.dev/guide/static-deploy.html#github-pages)

## アプリのビルド確認

```bash
npm run build
```

ビルドをする。エラーが出たらそのエラーは解消すること。

## ビルドしたソースをローカルで確認

```bash
npm run preview
```

build コマンドで生成された、dist ファイルを「http://localhost:4173 」で配信する。  
これで本番と同じソースで確認できる。

## vite.config.js の設定

GithubPages にデプロイする際の設定をする。

```
https://<USERNAME>.github.io/<REPO>/ にデプロイする場合（例: リポジトリーは https://github.com/<USERNAME>/<REPO>）、base を '/<REPO>/' と設定する。
```
