# React の基本

## state(状態)

データを保存する変数のこと。state でデータを管理し、データが変化することで画面の表示内容を動的に変更できる。

## Hooks(フック)

React16.8 から導入された機能で、関数コンポーネントでも状態管理や副作用の処理ができるようにする仕組み。  
代表的な Hooks は以下の通り。

| Hooks      | 役割                                     |
| ---------- | ---------------------------------------- |
| useState   | 状態管理（state）をする                  |
| useEffect  | 副作用処理（API 呼び出し、DOM 操作など） |
| useContext | コンテキスト（グローバル的な値共有       |
| useReducer | 複雑な状態管理                           |
| useRef     | DOM 参照や状態の保持                     |

### ■useState

useState とは、React の関数コンポーネントの中で状態を管理するための React Hooks の 1 つ。  
状態管理はコンポーネント内でデータを保持するということ。通常の変数ではなく状態管理を使う理由として、画面が際レンダリングされた場合でもデータを保持することができるから。

■ 基本構文

```js
import { useState } from "react";

const [count, setCount] = useState(0);
```

- useState は、`[値, 更新関数]`の配列を返す
- 更新は必ず更新関数で行う（直接代入すると React は、変化があったと気づかず UI が更新されない）
- 更新関数に値を渡すか、前の値を受け取る関数を渡すことができる

### ■useEffect

useEffect は関数コンポーネントで「副作用（side effect）」を実行するためのフック。  
副作用とは、コンポーネントの描画以外で起こる処理のこと。

■ 副作用の例

- API のリクエスト
- DOM の直接操作
- タイマーの開始、終了
- イベントリスナーの登録、解除

■ 基本構文

```js
import { useEffect } from "react";

useEffect(() => {
  // 副作用処理
  console.log("レンダー後に実行");

  // クリーンアップ関数
  // 目的：前のuseEffectで実行していた処理をクリーンアップすることで不要な処理を止める
  // 実行タイミング：コンポーネントがアンマウントされる時、依存配列の値が変わる直前
  return () => {
    console.log("コンポーネントの破棄時などに実行");
  };
}, [依存配列]);
```

useEffect()は、第一引数にコールバック関数、第二引数に依存配列を受け取る。  
第一引数のコールバック関数は、第二引数に指定した依存配列に含まれる値が変わった時に実行される。空の配列を指定した場合は、マウント時に 1 回だけ実行される。

クリーンアップ関数は、主に以下の 2 つのタイミングで実行される。

1. コンポーネントがアンマウント（画面から消える時、破棄される時）に最後に実行される。  
   例）ページ遷移や条件分岐で表示されなくなった時
2. 依存配列の値が変わる直前

■ 参考

- [React の基本、useEffect を理解しよう](https://envader.plus/article/444)
